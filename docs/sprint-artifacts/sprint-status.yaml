# Sprint Status - docuMINE
# ========================
# Generated: 2025-11-28
# Last Updated: 2025-12-09 (Story 21.5 review)
# Project: docuMINE
# Tracking: file-system
# Story Location: {project-root}/docs/sprint-artifacts

# ARCHIVED EPICS (1-13): See sprint-status-archive.yaml
# FUTURE EPICS (F3-F8): See sprint-status-future.yaml
# This file contains only active development (Epics 14-20)

# STATUS DEFINITIONS:
# Epic: backlog | contexted | done | abandoned | future | obsolete
# Story: backlog | drafted | ready-for-dev | in-progress | review | done
# Retrospective: optional | completed

development_status:
  # =====================================================
  # EPICS 1-13: ARCHIVED - See sprint-status-archive.yaml
  # =====================================================
  # All completed - MVP delivered 2025-12-07
  # Includes: Foundation, Auth, Documents, Chat, Comparison,
  # One-Pager, Enhanced Extraction, Processing Reliability,
  # Document AI (abandoned), LlamaParse Migration

  # =====================================================
  # AI BUDDY FEATURE - EPICS 14-20
  # =====================================================
  # Planning: docs/features/ai-buddy/
  # Total: 7 Epics, 55 Stories, 64 FRs

  # Epic 14: AI Buddy Foundation - DONE 2025-12-07
  # Database schema, API routes, navigation, layout shell, scaffolding
  epic-14-ai-buddy-foundation: done
  14-1-database-schema: done
  14-2-api-route-structure: done
  14-3-navigation-integration: done
  14-4-page-layout-shell: done
  14-5-component-scaffolding: done
  epic-14-retrospective: completed

  # Epic 15: AI Buddy Core Chat - DONE 2025-12-07
  # Conversational AI with streaming, citations, confidence
  # Tech Spec: docs/sprint-artifacts/epics/epic-15/tech-spec.md
  epic-15-ai-buddy-core-chat: done
  15-1-chat-input-component: done
  15-2-message-display: done
  15-3-streaming-chat-api: done
  15-4-conversation-persistence: done
  15-5-ai-response-quality-attribution: done  # Merged: 15.5-15.7
  epic-15-retrospective: completed

  # Epic 16: AI Buddy Projects - DONE 2025-12-08
  # Organize work by client accounts with persistent document context
  # Tech Spec: docs/sprint-artifacts/epics/epic-16/tech-spec.md
  epic-16-ai-buddy-projects: done
  16-1-project-creation-sidebar: done
  16-2-project-context-switching: done
  16-3-project-management: done
  16-4-conversation-history-general-chat: done
  16-5-conversation-search: done
  16-6-conversation-management: done
  epic-16-retrospective: completed

  # Epic 17: AI Buddy Document Intelligence - DONE 2025-12-08
  # Document upload, processing, AI-powered context
  # Tech Spec: docs/sprint-artifacts/epics/epic-17/tech-spec-epic-17.md
  epic-17-ai-buddy-document-intelligence: done
  17-1-document-upload-conversation-status: done
  17-2-project-document-management: done
  17-3-document-preview-multi-document-context: done
  17-4-document-processing-integration: done
  17-5-chatgpt-style-project-navigation: done
  epic-17-retrospective: completed

  # Epic 18: AI Buddy Personalization & Onboarding - DONE 2025-12-08
  # Personalized AI experience from first interaction
  # Tech Spec: docs/sprint-artifacts/epics/epic-18/tech-spec-epic-18.md
  epic-18-ai-buddy-personalization-onboarding: done
  18-1-onboarding-flow-guided-start: done
  18-2-preferences-management: done
  18-3-preference-aware-responses: done
  18-4-admin-onboarding-status: done
  epic-18-retrospective: completed

  # Epic 19: AI Buddy Guardrails & Compliance - DONE 2025-12-09
  # Admin-controlled guardrails for E&O protection
  # Tech Spec: docs/sprint-artifacts/epics/epic-19/tech-spec-epic-19.md
  # FRs: FR35-41
  # Stories: 4 (consolidated from 6)
  # Total Points: 13
  epic-19-ai-buddy-guardrails-compliance: done
  # Story 19.1: Guardrail Admin UI (5 pts) - DONE
  # Admin screen for restricted topics, rule toggles, immediate effect
  # IMPLEMENTED 2025-12-08: All ACs complete
  # - Restricted topics CRUD (add, edit, delete, toggle, built-in)
  # - Rule toggles (E&O protection, state compliance)
  # - Auto-save, immediate effect (no cache)
  # - Admin-only section (403 for non-admin)
  # - BONUS: Reset to defaults, sub-tabs UI, unsaved changes warning
  19-1-guardrail-admin-ui: done
  # Story 19.2: Enforcement & Logging (2 pts) - DONE
  # Audit log for guardrail events (FR38)
  # IMPLEMENTED 2025-12-09: All ACs complete
  # - API endpoint with date filtering and pagination
  # - Enforcement log table in GuardrailAdminPanel
  # - Detail dialog with full event information
  # - Permission-based access (view_audit_logs)
  # - 59 unit tests, E2E tests
  19-2-enforcement-logging: done
  # Story 19.3: Invisible Guardrail Responses (3 pts)
  # Helpful redirects for restricted topics (FR39)
  # DONE 2025-12-09: All ACs complete, review APPROVED - 76 new tests
  19-3-invisible-guardrail-responses: done
  # Story 19.4: AI Disclosure Message (3 pts)
  # Configurable disclosure text (FR40-41)
  # DONE 2025-12-09: All ACs complete, 59 tests passing, REVIEW APPROVED
  19-4-ai-disclosure-message: done
  epic-19-retrospective: completed

  # Epic 20: AI Buddy Admin & Audit - DONE 2025-12-09
  # User management, analytics, audit trail for compliance
  # Tech Spec: docs/sprint-artifacts/tech-spec-epic-20.md
  # FRs: FR42-56, FR64
  # Stories: 5 complete (20.6 moved to Epic 21)
  # Total Points: 23
  epic-20-ai-buddy-admin-audit: done
  # Story 20.1: Audit Log Infrastructure (3 pts)
  # Append-only RLS, immutability trigger, 7-year retention
  # FRs: FR54, FR55, FR56
  # Story 20.1 - DONE 2025-12-09: All ACs complete, 14 tests, review approved
  # - Immutability trigger prevents UPDATE/DELETE
  # - Partial index for guardrail metadata filtering
  # - 7-year retention policy documented
  20-1-audit-log-infrastructure: done
  # Story 20.2: Admin User Management (5 pts)
  # User list, invite, remove, role changes
  # FRs: FR42, FR43, FR44, FR45
  # Story 20.2 - DONE 2025-12-09: All ACs complete, 136+ tests, review approved
  # - Paginated user list with name, email, role, status, last active
  # - Search by name or email with debounce
  # - Invite new user via email with role selection
  # - Invitation expiration display (7 days)
  # - Remove user access (soft delete)
  # - Change user role (producer ↔ admin)
  # - Cannot modify owner protection
  # - Audit trail for all actions
  20-2-admin-user-management: done
  # Story 20.3: Usage Analytics Dashboard (5 pts)
  # Summary cards, per-user breakdown, trend charts
  # FRs: FR46, FR47
  # Story 20.3 - DONE 2025-12-09: All ACs complete, 55 unit tests + E2E tests
  # - Summary cards with K/M formatting and trend indicators
  # - Per-user breakdown table with sorting and pagination
  # - Line chart trends with recharts and tooltips
  # - Date range picker with presets (week, month, 30days)
  # - CSV export with proper headers
  # - Materialized view for <500ms performance
  # - Empty state for new teams
  # - Permission gating (view_usage_analytics)
  20-3-usage-analytics-dashboard: done
  # Story 20.4: Audit Log Interface (5 pts)
  # Filterable table, transcript viewer, PDF/CSV export
  # FRs: FR50, FR51, FR52, FR53
  # Story 20.4 - DONE 2025-12-09: All ACs complete, 98 unit tests + E2E
  # - Audit log table with date, user, project, conversation, message count, guardrail badge
  # - Multi-filter: user dropdown, date range, keyword search, guardrail checkbox
  # - Paginated at 25/page with total count
  # - Transcript modal (read-only) with messages, confidence badges, source citations
  # - Guardrail events highlighted with type and trigger info
  # - PDF export with agency header, compliance statement, optional transcripts
  # - CSV export with all required columns
  # - Permission gating (view_audit_logs)
  20-4-audit-log-interface: done
  # Story 20.5: Owner Management (5 pts) - CONSOLIDATED from 20.5 + 20.6
  # Billing/subscription management + ownership transfer
  # FRs: FR48, FR49
  # NOTE FROM SAM: Billing handled manually via Archway Computer invoices - no Stripe needed. Tiered plans remain (read-only display).
  # Story 20.5 - DONE 2025-12-09: All ACs complete, 35 unit tests + E2E
  # - Subscription panel with plan, billing cycle, seat allocation
  # - Billing contact info with email link
  # - Non-owner admin sees owner contact message
  # - Transfer ownership dialog with two-step confirmation
  # - Only admins listed as transfer targets
  # - Password confirmation required
  # - Atomic database transaction for transfer
  # - Email notifications to old and new owner
  # - Audit logging for ownership transfer
  20-5-owner-management: done
  # Story 20.6: Moved to Epic 21 - Admin consolidation makes this redundant
  # Feature navigation polish scope incorporated into Epic 21
  epic-20-retrospective: completed  # Combined with Epic 21: docs/sprint-artifacts/retrospectives/epic-20-21-retrospective.md

  # =====================================================
  # EPIC 21: AGENCY-WIDE ADMIN PLATFORM
  # =====================================================
  # Consolidate admin from AI Buddy scope to agency-wide
  # Decided 2025-12-09 via Party Mode discussion
  # Tech Spec: docs/sprint-artifacts/epics/epic-21/tech-spec/index.md
  # Stories: 5
  epic-21-agency-wide-admin-platform: done
  # Story 21.1: Database Migration - Agency Admin Tables (S)
  # Rename ai_buddy_permissions → agency_permissions
  # Rename ai_buddy_audit_logs → agency_audit_logs
  # Merge ai_buddy_invitations → invitations
  21-1-database-migration: done
  # Story 21.2: API Route Migration (S)
  # Move /api/ai-buddy/admin/* → /api/admin/*
  # Keep AI Buddy specific routes (guardrails, onboarding)
  # DONE 2025-12-09: All routes moved, hooks updated, tests passing
  21-2-api-route-migration: done
  # Story 21.3: Component & Settings Migration (M)
  # Move components/ai-buddy/admin/ → components/admin/
  # Add top-level Admin tab to Settings
  # Simplify AI Buddy tab to preferences only
  # DONE 2025-12-09: All components/hooks/lib migrated, Admin tab created
  # - Moved 20 test files, all 273 admin tests pass
  # - AC-7 review complete: No redundant tests found
  21-3-component-settings-migration: done
  # Story 21.4: Extend Audit Logging (S)
  # Add action types for documents, comparisons, one-pagers, chat
  # Update audit log UI for all action types
  # DONE 2025-12-09: All ACs complete - REVIEW APPROVED
  # - 8 new action types added to audit logger
  # - Document actions logged (upload, delete, modify)
  # - Comparison actions logged (create, export)
  # - One-pager actions logged (generate, export)
  # - Document chat sessions logged (new conversation)
  # - Audit log UI shows all action types with icons and badges
  # - Action category filtering in audit log
  21-4-extend-audit-logging: done
  # Story 21.5: Extend Usage Tracking (S)
  # Track usage across all features
  # Feature breakdown in analytics dashboard
  # DONE 2025-12-09: All ACs complete
  # - Usage analytics tracks Documents, Comparisons, One-Pagers, Doc Chat
  # - Feature breakdown in dashboard with stat cards
  # - Trend chart with Primary/All Features toggle
  # - User breakdown table with per-feature columns
  # - Export includes all features
  21-5-extend-usage-tracking: done
  # Story 21.2.5: Test Suite Consolidation (Team Discussion)
  # 2,796 tests across 175 files - brutal on local dev
  # Needs team input on consolidation strategy
  21-2.5-test-consolidation: done
  epic-21-retrospective: completed  # Combined with Epic 20: docs/sprint-artifacts/retrospectives/epic-20-21-retrospective.md

  # =====================================================
  # EPIC 22: UI POLISH SPRINT
  # =====================================================
  # Quick win - address "clunky" UX feeling
  # Decided: Epic 20-21 retrospective (2025-12-09)
  # Tech Spec: docs/sprint-artifacts/epics/epic-22/tech-spec.md
  # Stories: 4 (10 points total)
  epic-22-ui-polish: contexted
  # Story 22.1: Settings Tab Skeletons (3 pts) - P0
  # Add skeleton loaders to BrandingTab and UsageTab
  # DONE 2025-12-09: All ACs complete, 14 tests passing
  22-1-settings-tab-skeletons: done
  # Story 22.2: Admin Panel Skeletons (3 pts) - P0
  # Add skeleton loaders to Admin sub-panels
  # DONE 2025-12-09: Shared AdminPanelSkeleton created, 11 tests passing
  # Note: Existing admin panels already have good loading states
  22-2-admin-panel-skeletons: done
  # Story 22.3: View Transitions & Chart Fix (2 pts) - P1
  # Subtle fade-in transitions, fix Recharts warning
  # DONE 2025-12-09: View transitions added, Recharts already fixed
  22-3-view-transitions-chart-fix: done
  # Story 22.4: Spacing Standardization (2 pts) - P2
  # Standardize gap-6 and space-y-6 across pages
  22-4-spacing-standardization: drafted

  # =====================================================
  # EPIC 23+: CUSTOM REPORTING (After UI Polish)
  # =====================================================
  # User uploads raw data, AI normalizes and reports
  # Planning docs: docs/features/reporting/
  # Duration: ~3-4 weeks
  epic-23-custom-reporting: backlog
  # Scope:
  # - File upload for Excel/CSV/PDF
  # - AI column detection and normalization
  # - Structured data storage
  # - Natural language querying via AI Buddy
  # - Chart and report generation
