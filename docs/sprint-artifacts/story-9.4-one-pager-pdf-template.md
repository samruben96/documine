# Story 9.4: One-Pager PDF Template

**Status:** Draft

---

## User Story

As an **insurance agent**,
I want generated one-pagers to look professional with my agency branding,
So that I can confidently share them with clients.

---

## Acceptance Criteria

### AC-9.4.1: Agency Header
**Given** I generate a one-pager
**When** I view the PDF
**Then** I see the agency logo (or name if no logo) and generation date in the header

### AC-9.4.2: Client Information
**Given** I entered a client name
**When** I view the PDF
**Then** I see "Prepared for: [Client Name]" and "Prepared by: [Agent Name]"

### AC-9.4.3: Coverage Comparison Table
**Given** I generate a one-pager from a comparison
**When** I view the PDF
**Then** I see a coverage comparison table with all carriers and coverages

### AC-9.4.4: Premium Summary
**Given** I generate a one-pager
**When** I view the PDF
**Then** I see a premium summary section highlighting the annual premiums

### AC-9.4.5: Gaps Section
**Given** the comparison has identified gaps
**When** I view the PDF
**Then** I see a "Coverage Gaps" section listing the gaps

### AC-9.4.6: Agent Notes
**Given** I entered agent notes
**When** I view the PDF
**Then** I see an "Agent Notes" section with my recommendation

### AC-9.4.7: Footer with Contact
**Given** I generate a one-pager
**When** I view the PDF
**Then** I see a footer with agency contact info and "Generated by docuMINE"

### AC-9.4.8: Single Page Fit
**Given** I generate a one-pager with typical data (3 carriers, 10 coverages)
**When** I view the PDF
**Then** the content fits on a single US Letter page

### AC-9.4.9: Brand Colors
**Given** agency has configured primary/secondary colors
**When** I view the PDF
**Then** the headers and accents use the agency's brand colors

---

## Implementation Details

### Tasks / Subtasks

- [ ] Create `src/lib/one-pager/types.ts` with OnePagerData interface (AC: all)
- [ ] Create `src/lib/one-pager/template.tsx` with @react-pdf/renderer Document (AC: all)
- [ ] Implement `AgencyHeader` component with logo/name and date (AC: #1)
- [ ] Implement `TitleSection` with client and agent info (AC: #2)
- [ ] Implement `ComparisonTable` component reusing diff.ts patterns (AC: #3)
- [ ] Implement `PremiumSummary` component (AC: #4)
- [ ] Implement `GapsSection` component (AC: #5)
- [ ] Implement `AgentNotes` component (AC: #6)
- [ ] Implement `Footer` component with contact info (AC: #7)
- [ ] Create StyleSheet with brand color variables (AC: #9)
- [ ] Test single-page fit with various data sizes (AC: #8)
- [ ] Implement logo base64 conversion for reliable rendering (AC: #1)
- [ ] Create `src/lib/one-pager/generator.ts` service function (AC: all)
- [ ] Write unit tests for generator (AC: all)

### Technical Summary

This story creates the PDF document template using @react-pdf/renderer, following the proven pattern from `pdf-export.tsx`. The template is composed of modular sections (header, table, summary, gaps, notes, footer) that conditionally render based on available data. Brand colors are applied via a dynamic StyleSheet that reads from the branding configuration. Logo images are converted to base64 for reliable embedding.

### Project Structure Notes

- **Files to create:**
  - `src/lib/one-pager/types.ts`
  - `src/lib/one-pager/template.tsx`
  - `src/lib/one-pager/generator.ts`
- **Files to modify:** None
- **Expected test locations:**
  - `__tests__/lib/one-pager/generator.test.ts`
  - `__tests__/lib/one-pager/template.test.tsx`
- **Estimated effort:** 3 story points
- **Prerequisites:** Story 9.1 (branding), Story 9.3 (page integration)

### Key Code References

| File | Purpose |
|------|---------|
| `src/lib/compare/pdf-export.tsx` | Primary pattern - @react-pdf/renderer usage |
| `src/lib/compare/diff.ts` | ComparisonTableData structure |
| `src/lib/compare/export.ts` | Date formatting, download utilities |
| `docs/research-one-pager-ux-2025-12-03.md` | Template layout design |

---

## Context References

**Tech-Spec:** [tech-spec-epic-9.md](./tech-spec-epic-9.md) - Primary context document containing:
- Template layout diagram
- Section specifications
- Color scheme details
- Logo handling approach

**UX Research:** [research-one-pager-ux-2025-12-03.md](../research-one-pager-ux-2025-12-03.md)
- Professional template best practices
- Insurance one-pager examples
- Typography and spacing guidelines

---

## Dev Agent Record

### Agent Model Used
<!-- Will be populated during dev-story execution -->

### Debug Log References
<!-- Will be populated during dev-story execution -->

### Completion Notes
<!-- Will be populated during dev-story execution -->

### Files Modified
<!-- Will be populated during dev-story execution -->

### Test Results
<!-- Will be populated during dev-story execution -->

---

## Review Notes

<!-- Will be populated during code review -->
